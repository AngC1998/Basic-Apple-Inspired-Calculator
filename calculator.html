<!DOCTYPE HTML>
<head>
    <link rel = "stylesheet" href = "calculator.css">
    <script src="http://code.jquery.com/jquery-1.11.0.min.js"></script>
    <!--<script src = "calculator.js"></script>-->
    <!-- jQuery library -->
    <script src="https://ajax.googleapis.com/ajax/libs/jquery/1.12.4/jquery.min.js"></script>
    <!-- Latest compiled JavaScript -->
    <script src="http://maxcdn.bootstrapcdn.com/bootstrap/3.3.6/js/bootstrap.min.js"></script>
</head>

<body>
    <div class = "container">
        <div class = "item item-header" id = "currentValue">0</div>
    
        <button class = "btn silver clear">AC</button>
        <button class = "btn silver">+/-</button>
        <button class = "btn silver percent">%</button>
        <button class = "btn orange divide">/</button>
        <button class = "btn extra">(</button>
        <button class = "btn extra">)</button>
        <button class = "btn extra">mc</button>
        <button class = "btn extra">m+</button>
        <button class = "btn extra">m-</button>
        <button class = "btn extra">mr</button> 
    
        <button class = "btn num">7</button>
        <button class = "btn num">8</button>
        <button class = "btn num">9</button>
        <button class = "btn orange multiply">X</button>
        <button class = "btn extra">2nd</button>
        <button class = "btn extra">x^2</button>
        <button class = "btn extra">x^3</button>
        <button class = "btn extra">x^y</button>
        <button class = "btn extra">e^x</button>
        <button class = "btn extra">10^x</button> 
    
        <button class = "btn num">4</button>
        <button class = "btn num">5</button>
        <button class = "btn num">6</button>
        <button class = "btn orange subtract">-</button>
        <button class = "btn extra">1/x</button>
        <button class = "btn extra">sqrt(x)</button>
        <button class = "btn extra">cbrt(x)</button>
        <button class = "btn extra">yrt(x)</button>
        <button class = "btn extra">ln</button>
        <button class = "btn extra">log10</button> 
    
        <button class = "btn num">1</button>
        <button class = "btn num">2</button>
        <button class = "btn num">3</button>
        <button class = "btn orange add">+</button>
        <button class = "btn extra">x!</button>
        <button class = "btn extra">sin</button>
        <button class = "btn extra">cos</button>
        <button class = "btn extra">tan</button>
        <button class = "btn extra">e</button>
        <button class = "btn extra">EE</button> 
        
        <button class = "btn num zero">0</button>
        <button class = "btn num">.</button>
        <button class = "btn equals">=</button>
        <button class = "btn extra">Rad</button>
        <button class = "btn extra">sinh</button>
        <button class = "btn extra">cosh</button>
        <button class = "btn extra">tanh</button>
        <button class = "btn extra">pi</button>
        <button class = "btn extra">Rand</button> 
        
        <script>
            var globalAnswer = "0";
            var isPercent = false; 
            function removeLeadingZero(string) {
                console.log("removeLeadingZero");
                var newString = string; 
                if(newString[0] === '0') {
                    newString = newString.slice(1);
                }
                return newString; 
            }
            function removeLeadingSymbol(string) {
                console.log("removeLeadingSymbol");
                var newString = string;
                var symbols = ["*", "/", "+", "-"];
                if(symbols.includes(newString[0])) {
                    newString = newString.slice(1);
                }
                return newString; 
            }
            function storeAnswer(value) {
                console.log("storeAnswer");
                var valued = removeLeadingZero(value); 
                globalAnswer = valued; 
                $("#globalAnswer").html(globalAnswer); 
                return value; 
            }
            function getCurrentValue() {
                console.log("getCurrentValue");
                var currentValue = document.getElementById("currentValue").innerHTML;
                return currentValue;
            }
            function clearCurrentValue() {
                console.log("clearCurrentValue");
                $("#currentValue").html("0");
                changeBackground(); 
                return storeAnswer("0");
            }
            function equals(event) {
                console.log("equals");
                var answer = globalAnswer; 
                var removeEqualsSign = answer.split("=");
                var newAnswer = removeEqualsSign[0];
                newAnswer = replaceTimes(newAnswer);
                newAnswer = removeLeadingSymbol(newAnswer);
                var finalAnswer = eval(newAnswer);
                finalAnswer = finalAnswer.toString(); 
                storeAndReset(finalAnswer, finalAnswer);
                changeBackground(); 
                return finalAnswer; 
            }
            function clickButton(event) {
                $(".btn").click(function(event){
                    var thingClicked = this.innerHTML;
                    console.log("clickButton");
                    
                    if($(this).hasClass("orange")) {
                        return addSymbolToAnswer(thingClicked);
                    }
                    if($(this).hasClass("clear")) {
                        return clearCurrentValue(); 
                    }
                    if($(this).hasClass("equals")) {
                        addSymbolToAnswer(thingClicked);
                        return equals(); 
                    }
                    if($(this).hasClass("num")) {
                        return createNewNumber(thingClicked);
                    }
                    if($(this).hasClass("percent")) {
                        isPercent = true; 
                        return percent(thingClicked); 
                    }
                })
            }clickButton(event);
            function replaceTimes(string) {
                console.log("replaceTimes");
                string = string.replace("X", "*");
                return string; 
            }
            function addSymbolToAnswer(string) {
                console.log("addSymbolToAnswer");
                var symbolString = string;
                symbolString = replaceTimes(string);
                var currentValue = getCurrentValue(); 
                var symbols = ["*", "/", "+", "-"];
                console.log("globalAnswer", globalAnswer);
                console.log("currentValue", currentValue);
                console.log("symbolString", symbolString);
                if(globalAnswer === currentValue) {
                    var newGlobalAnswer = currentValue + symbolString; 
                    return storeAndReset(newGlobalAnswer, symbolString);
                }
                if(symbols.includes(currentValue)) {
                    currentValue = currentValue.replace(currentValue, symbolString);
                    var newGlobalAnswer = globalAnswer.slice(0, -1) + currentValue; 
                    return storeAndReset(newGlobalAnswer, symbolString);
                }
                else {
                    currentValue = currentValue + symbolString; 
                    var newGlobalAnswer = globalAnswer + currentValue; 
                    return storeAndReset(newGlobalAnswer, symbolString);
                }
            }
            function percent(string) {
                $(".btn").click(function(event) {
                    var thingClicked = this.innerHTML;
                    console.log("percent");
                    
                    if($(this).hasClass("num") && isPercent === true) {
                        var nextNum = parseInt(thingClicked);
                        var result = nextNum / 100.0; 
                        $("#currentValue").html(result);
                        storeAnswer(result);
                        isPercent = false; 
                        return result; 
                    }
                    
                    return thingClicked; 
                })
            }
            function storeAndReset(newGlobalAnswer, newCurrentValue) {
                console.log("storeAndReset");
                storeAnswer(newGlobalAnswer);
                console.log("globalAnswer2", globalAnswer);
                console.log("currentValue2", currentValue);
                $("#currentValue").html(newCurrentValue); 
                return newCurrentValue; 
            }
            function createNewNumber(string) {
                console.log("createNewNumber");
                var thingClicked = string; 
                var currentValue = getCurrentValue(); 
                var newString = currentValue + thingClicked;
                console.log("newString", newString)
                newString = removeLeadingZero(newString);
                newString = removeLeadingSymbol(newString);
                $("#currentValue").html(newString);
                console.log("globalAnswer3", globalAnswer);
                console.log("currentValue3", currentValue);
                changeBackground(); 
                return newString; 
            }
            function changeBackground() {
                var currentValue = document.getElementById("currentValue").innerHTML; 
                if(currentValue === "1888") {
                    $(document.body).addClass('background-UT-Tower'); 
                }
                if(currentValue != "1888") {
                    $(document.body).removeClass('background-UT-Tower'); 
                }
                if(currentValue === "3.14") {
                    $(document.body).addClass('background-pi');
                }
                if(currentValue != "3.14") {
                    $(document.body).removeClass('background-pi'); 
                }
            }
        </script> 
    </div>
</body>